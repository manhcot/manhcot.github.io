<!DOCTYPE html><html lang="en"><head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="M·ªü ƒë·∫ßuFlare-on CTFFlare-on l√† s√¢n ch∆°i CTF h√†ng nƒÉm c·ªßa nh·ªØng ng∆∞·ªùi ch∆°i h·ªá nh·ªã ph√¢n üë®‚Äçüíª, reverse engineer, c√°c nh√† nghi√™n c·ª©u v·ªÅ m√£ ƒë·ªôc v√† b·∫£o m·∫≠t. M·ªôt k·ª≥ Flare-on">
<meta property="og:type" content="article">
<meta property="og:title" content="FLAREON 2020 - WRITEUP PH·∫¶N 1">
<meta property="og:url" content="https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/index.html">
<meta property="og:site_name" content="/ home / cyberjutsu / blog /">
<meta property="og:description" content="M·ªü ƒë·∫ßuFlare-on CTFFlare-on l√† s√¢n ch∆°i CTF h√†ng nƒÉm c·ªßa nh·ªØng ng∆∞·ªùi ch∆°i h·ªá nh·ªã ph√¢n üë®‚Äçüíª, reverse engineer, c√°c nh√† nghi√™n c·ª©u v·ªÅ m√£ ƒë·ªôc v√† b·∫£o m·∫≠t. M·ªôt k·ª≥ Flare-on">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-12-02T17:00:01.000Z">
<meta property="article:modified_time" content="2020-12-31T03:35:13.713Z">
<meta property="article:author" content="CyberJutsu Team">
<meta property="article:tag" content="flareon">
<meta property="article:tag" content="reverse engineering">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.cyberjutsu.io/images/flareon/1/1.png">
<meta property="og:image" content="images/1_3.png">
    
    
      
        
          <link rel="shortcut icon" href="favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>FLAREON 2020 - WRITEUP PH·∫¶N 1</title>
    <!-- styles -->
    
<link rel="stylesheet" href="css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.2.0"></head>

<body class="max-width mx-auto px5 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" style="display: none;"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav" style="display: none;">
      <ul>
         
          <li><a href="/">home</a></li>
         
          <li><a href="/about/">about</a></li>
         
          <li><a href="/archives/">articles</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://cyberjutsu.io/publications/">publications</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/12/24/flareon-phan-2/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;text=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;is_video=false&amp;description=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=FLAREON 2020 - WRITEUP PH·∫¶N 1&amp;body=Check out this article: https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;name=FLAREON 2020 - WRITEUP PH·∫¶N 1&amp;description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;t=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mo-dau"><span class="toc-number">1.</span> <span class="toc-text">M·ªü ƒë·∫ßu</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Flare-on-CTF"><span class="toc-number">1.1.</span> <span class="toc-text">Flare-on CTF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vi-sao-nen-choi-Flare-on"><span class="toc-number">1.2.</span> <span class="toc-text">V√¨ sao n√™n ch∆°i Flare-on</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Phan-1"><span class="toc-number">1.3.</span> <span class="toc-text">Ph·∫ßn 1</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Fidler"><span class="toc-number">2.</span> <span class="toc-text">1 - Fidler</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-garbage"><span class="toc-number">3.</span> <span class="toc-text">2 - garbage</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-Wednesday"><span class="toc-number">4.</span> <span class="toc-text">3 - Wednesday</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        FLAREON 2020 - WRITEUP PH·∫¶N 1
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">manhcot</span>
      </span>&gt;&gt;
      
    <div class="postdate">
      
        <time datetime="2020-12-02T17:00:01.000Z" itemprop="datePublished">2020-12-03</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/flareon/" rel="tag">flareon</a>, <a class="tag-link-link" href="/tags/reverse-engineering/" rel="tag">reverse engineering</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <main style="height: 400px">
  <div class="c-glitch" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);">
    <div class="c-glitch__img" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);"></div>
    <div class="c-glitch__img" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);"></div>
    <div class="c-glitch__img" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);"></div>
    <div class="c-glitch__img" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);"></div>
    <div class="c-glitch__img" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);"></div>
  </div>
</main>

<h1 id="Mo-dau"><a href="#Mo-dau" class="headerlink" title="M·ªü ƒë·∫ßu">M·ªü ƒë·∫ßu</a></h1><h2 id="Flare-on-CTF"><a href="#Flare-on-CTF" class="headerlink" title="Flare-on CTF">Flare-on CTF</a></h2><p>Flare-on l√† s√¢n ch∆°i CTF h√†ng nƒÉm c·ªßa nh·ªØng ng∆∞·ªùi ch∆°i h·ªá nh·ªã ph√¢n üë®‚Äçüíª, reverse engineer, c√°c nh√† nghi√™n c·ª©u v·ªÅ m√£ ƒë·ªôc v√† b·∫£o m·∫≠t. M·ªôt k·ª≥ Flare-on CTF di·ªÖn ra trong v√≤ng 6 tu·∫ßn, th√¥ng th∆∞·ªùng g·ªìm 11 challenge t∆∞∆°ng ·ª©ng v·ªõi 11 level ƒë·∫ßy ƒë·ªß c√°c th·ªÉ lo·∫°i v√† platform (Windows, Linux, Python, VBA, .NET, ‚Ä¶)</p>
<h2 id="Vi-sao-nen-choi-Flare-on"><a href="#Vi-sao-nen-choi-Flare-on" class="headerlink" title="V√¨ sao n√™n ch∆°i Flare-on">V√¨ sao n√™n ch∆°i Flare-on</a></h2><ul>
<li>C√°c challenge n√†y ƒë∆∞·ª£c <code>Fireeye</code> m√¥ t·∫£ l√† ‚Äúm·ªôt trong nh·ªØng v·∫•n ƒë·ªÅ m√† team <code>Fireeye</code> ph·∫£i ƒë·ªëi m·∫∑t h·∫±ng ng√†y‚Äù, t·ª©c l√† nh·ªØng challenge n√†y ƒë·ªÅu l·∫•y √Ω t∆∞·ªüng t·ª´ nh·ªØng v·∫•n ƒë·ªÅ c√≥ th·∫≠t (c√≥ b√†i d√πng c·∫£ malware th·∫≠t), n√™n ƒë·ªÅ b√†i s·∫Ω c√≥ c·∫£m gi√°c ‚Äúreal-world‚Äù h∆°n so v·ªõi c√°c b√†i <code>RE</code> trong c√°c ƒë·ªÅ thi <code>CTF</code> kh√°c.</li>
<li>N·∫øu b·∫°n l√† 1 ng∆∞·ªùi ch∆°i <code>RE</code> th√¨ kh√¥ng n√™n b·ªè qua Flare-on, nh·∫•t l√† v·ªõi c√°c b·∫°n m·ªõi ch∆°i <code>RE</code>. B·ªüi v√¨, ƒë·ªÅ Flare-on tuy kh√≥, c√°c b·∫°n c√≥ th·ªÉ kh√¥ng gi·∫£i h·∫øt c√°c challenge, nh∆∞ng trong v√≤ng 6 tu·∫ßn ƒë√≥ b·∫°n s·∫Ω h·ªçc ƒë∆∞·ª£c nhi·ªÅu th·ª© m·ªõi (nh∆∞ t√≠nh ki√™n tr√¨ ch·∫≥ng h·∫°n üòÑ !!)</li>
<li>Sau khi k√¨ thi k·∫øt th√∫c, <code>Fireeye</code> s·∫Ω ƒë∆∞a ra l·ªùi gi·∫£i chi ti·∫øt cho c√°c challenge, b·∫°n c√≥ th·ªÉ tham kh·∫£o c√°ch h·ªç l√†m. Ngo√†i ra tr√™n m·∫°ng c≈©ng c√≥ r·∫•t nhi·ªÅu write-up cho c√°c b·∫°n tham kh·∫£o, t·ª´ ƒë√≥ b·∫°n c√≥ th·ªÉ h·ªçc h·ªèi c√°ch h·ªç l√†m, h·ªçc c√°ch ti·∫øp c·∫≠n b√†i to√°n, d√πng tool ƒë·ªÉ gi·∫£i b√†i, ‚Ä¶</li>
</ul>
<p>M√¨nh b·∫Øt ƒë·∫ßu ch∆°i Flare-on  t·ª´ nƒÉm ngo√°i, v√† c≈©ng kh√¥ng gi·∫£i ƒë∆∞·ª£c h·∫øt c√°c challenge,  tuy nhi√™n √≠t nh·∫•t m√¨nh ƒë√£ kh√¥ng b·ªè cu·ªôc cho t·ªõi ph√∫t cu·ªëi c√πng. NƒÉm nay m√¨nh ti·∫øp t·ª•c tham gia Flare-on v√† ƒë√£ gi·∫£i ƒë∆∞·ª£c ƒë·ªß 11 b√†i, v√† ƒë√¢y l√† write-up cho 11 b√†i ƒë√≥ !</p>
<h2 id="Phan-1"><a href="#Phan-1" class="headerlink" title="Ph·∫ßn 1">Ph·∫ßn 1</a></h2><p>M√¨nh s·∫Ω chia 11 b√†i writeup ra th√†nh nhi·ªÅu ph·∫ßn kh√°c nhau üòÑ, ·ªü ph·∫ßn 1 n√†y ch√∫ng ta c√πng kh·ªüi ƒë·ªông v·ªõi 3 b√†i ƒë·∫ßu ti√™n ƒë√≥ ch√≠nh l√†: <code>Fidler</code> (<a href="/static/flareon2020/solution1.zip">solution</a>), <code>garbage</code> (<a href="/static/flareon2020/solution2.zip">solution</a>) v√† <code>Wednesday</code> (<a href="/static/flareon2020/solution3.zip">solution</a>)</p>
<h1 id="1-Fidler"><a href="#1-Fidler" class="headerlink" title="1 - Fidler">1 - Fidler</a></h1><figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the Seventh Flare-On Challenge!</span><br><span class="line"></span><br><span class="line">This is a simple game. Win it by any means necessary and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level.</span><br><span class="line"></span><br><span class="line">This challenge is written in Python and is distributed as a runnable EXE and matching source code for your convenience. You can run the source code directly on any Python platform with PyGame if you would prefer.</span><br></pre></td></tr></tbody></table></figure>

<p>Nh∆∞ ti√™u ƒë·ªÅ, b√†i n√†y bao g·ªìm file <code>.exe</code> v√† file source code <code>.py</code>.</p>
<p><img src="images/1_1.png"></p>
<p>Ch·∫°y file exe:</p>
<p><img src="images/2.png"></p>
<p>Ch∆∞∆°ng tr√¨nh y√™u c·∫ßu nh·∫≠p password, ta m·ªü source code ra:</p>
<p><img src="images/3.png"></p>
<p>Ta d·ªÖ d√†ng l·∫•y ƒë∆∞·ª£c password l√† <code>ghost</code>, nh·∫≠p v√†o, ta s·∫Ω chuy·ªÉn sang m√†n h√¨nh ti·∫øp theo:</p>
<p><img src="images/4.png"></p>
<p>Ta ph·∫£i click v√†o con m√®o 100 t·ª∑ l·∫ßn ƒë·ªÉ l·∫•y ƒë∆∞·ª£c flag, ho·∫∑c ta c√≥ th·ªÉ xem ch∆∞∆°ng tr√¨nh t·∫°o flag nh∆∞ n√†o ƒë·ªÉ c√≥ th·ªÉ l·∫•y ƒë∆∞·ª£c n√≥.</p>
<p>Ta c√≥ th·ªÉ m·ªü source code c·ªßa game n√†y ra ƒë·ªÉ ƒë·ªçc, ƒë√≥ ch√≠nh l√† file <code>fidler.py</code>, l∆∞·ªõt qua nh√¨n t√™n c√°c h√†m th√¨ c√≥ m·ªôt h√†m li√™n quan t·ªõi ‚Äúflag‚Äù, ƒë√≥ l√† h√†m <code>decode_flag</code>:</p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_flag</span>(<span class="params">frob</span>):</span></span><br><span class="line">    last_value = frob</span><br><span class="line">    encoded_flag = [<span class="number">1135</span>, <span class="number">1038</span>, <span class="number">1126</span>, <span class="number">1028</span>, <span class="number">1117</span>, <span class="number">1071</span>, <span class="number">1094</span>, <span class="number">1077</span>, <span class="number">1121</span>, <span class="number">1087</span>, <span class="number">1110</span>, <span class="number">1092</span>, <span class="number">1072</span>, <span class="number">1095</span>, <span class="number">1090</span>, <span class="number">1027</span>,</span><br><span class="line">                    <span class="number">1127</span>, <span class="number">1040</span>, <span class="number">1137</span>, <span class="number">1030</span>, <span class="number">1127</span>, <span class="number">1099</span>, <span class="number">1062</span>, <span class="number">1101</span>, <span class="number">1123</span>, <span class="number">1027</span>, <span class="number">1136</span>, <span class="number">1054</span>]</span><br><span class="line">    decoded_flag = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encoded_flag)):</span><br><span class="line">        c = encoded_flag[i]</span><br><span class="line">        val = (c - ((i%<span class="number">2</span>)*<span class="number">1</span> + (i%<span class="number">3</span>)*<span class="number">2</span>)) ^ last_value</span><br><span class="line">        decoded_flag.append(val)</span><br><span class="line">        last_value = c</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> decoded_flag])</span><br></pre></td></tr></tbody></table></figure>

<p>Sau ƒë√≥ select ch·ªØ <code>"decode_flag"</code> trong <code>notepad++</code>, th√¨ n√≥ s·∫Ω t·ª± select t·∫•t c·∫£ c√°c ch·ªó kh√°c c√≥ ch·ª©a <code>"decode_flag"</code></p>
<p><img src="images/7.png"></p>
<p>Ta c√≥ th·ªÉ th·∫•y 1 reference kh√°c c·ªßa <code>"decode_flag"</code> ·ªü h√†m <code>victory_screen</code>, ta l·∫°i ti·∫øp t·ª•c select ch·ªØ <code>"victory_screen"</code> ƒë·ªÉ t√¨m reference:</p>
<p><img src="images/8_1.png"></p>
<p>Ta l·∫°i ti·∫øp t·ª•c l√†m nh∆∞ tr√™n v·ªõi h√†m <code>game_screen</code>:</p>
<p><img src="images/9.png"></p>
<p>V·∫≠y l√† ta ƒë√£ bi·∫øt h√†m <code>game_screen</code> ƒë∆∞·ª£c g·ªçi nh∆∞ n√†o, tuy nhi√™n ƒëi·ªÅu ƒë√≥ c≈©ng kh√¥ng qu√° quan tr·ªçng v√¨ ta s·∫Ω ch·ªâ quan t√¢m t·ªõi h√†m <code>decode_flag</code>.</p>
<p>Ch·ªâ c√≥ duy nh·∫•t 1 ch·ªó g·ªçi h√†m <code>decode_flag</code>, ƒë√≥ l√† ch·ªó n√†y:</p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ... truncated </span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> done:</span><br><span class="line">    target_amount = (<span class="number">2</span>**<span class="number">36</span>) + (<span class="number">2</span>**<span class="number">35</span>)</span><br><span class="line">    <span class="keyword">if</span> current_coins &gt; (target_amount - <span class="number">2</span>**<span class="number">20</span>):</span><br><span class="line">        <span class="keyword">while</span> current_coins &gt;= (target_amount + <span class="number">2</span>**<span class="number">20</span>):</span><br><span class="line">            current_coins -= <span class="number">2</span>**<span class="number">20</span></span><br><span class="line">        victory_screen(<span class="built_in">int</span>(current_coins / <span class="number">10</span>**<span class="number">8</span>))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"><span class="comment"># truncated ...</span></span><br></pre></td></tr></tbody></table></figure>

<p>D·ªÖ th·∫•y <code>current_coin</code> ph·∫£i l·ªõn h∆°n ho·∫∑c b·∫±ng <code>2**36+2**35</code> v√† b√© h∆°n <code>2**36+2**35+2**20</code> th√¨ d√≤ng <code>victory_screen(int(current_coins / 10**8))</code> m·ªõi ƒë∆∞·ª£c g·ªçi.</p>
<p>Khi ƒë√≥ ta vi·∫øt l·∫°i ƒëo·∫°n code ·ªü tr√™n v·ªõi <code>frob=int((2**36+2**35)/10**8)</code></p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> (decode_flag(<span class="built_in">int</span>((<span class="number">2</span>**<span class="number">36</span>+<span class="number">2</span>**<span class="number">35</span>)/<span class="number">10</span>**<span class="number">8</span>)))</span><br></pre></td></tr></tbody></table></figure>

<p>Run:</p>
<figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">idle_with_kitty@flare-on.com</span><br></pre></td></tr></tbody></table></figure>


<h1 id="2-garbage"><a href="#2-garbage" class="headerlink" title="2 - garbage">2 - garbage</a></h1><figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">One of our team members developed a Flare-On challenge but accidentally deleted it. We recovered it using extreme digital forensic techniques but it seems to be corrupted. We would fix it but we are too busy solving today's most important information security threats affecting our global economy. You should be able to get it working again, reverse engineer it, and acquire the flag.</span><br></pre></td></tr></tbody></table></figure>

<p><img src="images/1.png"></p>
<p>Ta gi·∫£i n√©n v√† ch·∫°y th·ª≠ file exe:</p>
<p><img src="images/2_2.png"></p>
<p>File ƒë√£ b·ªã corrupt ƒë√∫ng nh∆∞ ƒë·ªÅ b√†i n√≥i. Ti·∫øp theo ta d√πng <code>Detect it easy</code> ƒë·ªÉ l·∫•y th√™m th√¥ng tin v·ªÅ file.</p>
<p><img src="images/3_1.png"></p>
<blockquote>
<p><code>Detect it easy</code> l√† m·ªôt tool d√πng ƒë·ªÉ x√°c ƒë·ªãnh xem 1 file <code>PE</code> ƒë∆∞·ª£c bi√™n d·ªãch b·∫±ng compiler n√†o, ƒë∆∞·ª£c pack b·∫±ng packer n√†o, t·ª´ ƒë√≥ ta c√≥ th·ªÉ c√≥ s·ª≠ d·ª•ng c√°c tool th√≠ch h·ª£p ƒë·ªÉ ph√¢n t√≠ch file ƒë√≥.</p>
</blockquote>
<p>File ƒë∆∞·ª£c n√©n b·∫±ng <code>UPX</code>, ta s·∫Ω d√πng ƒë√∫ng tool <code>UPX</code> ƒë·ªÉ unpack file n√†y.</p>
<p><img src="images/4_1.png"></p>
<blockquote>
<p><code>UPX</code> l√† m·ªôt tool d√πng ƒë·ªÉ n√©n file executable, open source, b·∫°n ƒë·ªçc c√≥ th·ªÉ xem ·ªü <a target="_blank" rel="noopener" href="https://upx.github.io/">ƒë√¢y</a>.</p>
</blockquote>
<p><code>UPX</code> kh√¥ng th·ªÉ unpack file n√†y, c√≥ th·ªÉ l√† v√¨ n√≥ ƒë√£ b·ªã l·ªói. Gi·ªù ta m·ªü file l√™n b·∫±ng <code>PE-bear</code> ƒë·ªÉ xem ph·∫ßn n√†o trong file n√†y b·ªã l·ªói.</p>
<p><img src="images/5.png"></p>
<p><img src="images/6.png"></p>
<blockquote>
<p><code>PE-bear</code> l√† m·ªôt tool d√πng ƒë·ªÉ xem PE header c·ªßa 1 file PE, b·∫°n ƒë·ªçc c√≥ th·ªÉ t·∫£i ·ªü <a target="_blank" rel="noopener" href="https://hshrzd.wordpress.com/pe-bear/">ƒë√¢y</a>.</p>
</blockquote>
<p>Ta th·∫•y ngay ph·∫ßn section <code>.rsrc</code> b·ªã l·ªói (m√†u ƒë·ªè).</p>
<p>Ta ph√¢n t√≠ch ti·∫øp: m·ª•c <code>.rsrc</code> c√≥ <code>Raw size</code> l√† <code>0x124</code>, t·ª©c l√† khi map file l√™n b·ªô nh·ªõ t·∫°i <code>Virtual address 0x19000</code>, ph·∫ßn data th·∫≠t s·ª± s·∫Ω k·∫øt th√∫c ·ªü <code>0x19123</code>, trong khi ·ªü h√¨nh tr√™n th√¨ ph·∫ßn <code>Import Directory</code> b·∫Øt ƒë·∫ßu ·ªü <code>Virtual address 0x191DC</code>, t·ª©c l√† n·∫±m ngo√†i v√πng data th·∫≠t s·ª± (3 v√πng m√†u ƒë·ªè ·ªü h√¨nh tr√™n ƒë·ªÅu n·∫±m ngo√†i v√πng data).</p>
<p>Nh∆∞ v·∫≠y ta ch·ªâ c·∫ßn pad th√™m v√†o file c√°c byte null ƒë·ªÉ n√≥ c√≥ th·ªÉ bao h·∫øt c√°c <code>Virtual address</code> tr√™n. Ta c·∫ßn th√™m v√†o <code>0x1929C+0x10-(0x19000+0x124) = 0x188</code> byte.</p>
<p>Nh∆∞ng ch∆∞a ƒë·ªß, n·∫øu ta th√™m ch·ªâ ch·ª´ng ƒë√≥ byte th√¨ ch∆∞a ch·∫Øc file ƒë√£ ‚Äúho·∫°t ƒë·ªông‚Äù ƒë∆∞·ª£c, v√¨ dung l∆∞·ª£ng c·ªßa file ph·∫£i chia h·∫øt cho <code>File alignment</code> (tham kh·∫£o v·ªÅ PE struct t·∫°i <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/debug/pe-format">ƒë√¢y</a>).</p>
<p><img src="images/8.png"></p>
<p>Nh∆∞ h√¨nh tr√™n, <code>File alignment</code> l√† <code>0x200</code>. V·∫≠y l√† sau khi th√™m, ta ph·∫£i ƒë·∫£m b·∫£o l√† size c·ªßa file n√†y chia cho <code>0x200</code> d∆∞ 0, ƒëo·∫°n code d∆∞·ªõi ƒë√¢y m√¨nh ƒë√£ pad th√™m cho t·ªõi b·ªôi c·ªßa <code>0x200</code> l√† <code>0x400</code>.</p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'garbage.exe'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'fix.exe'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f2:</span><br><span class="line">            data = f.read()</span><br><span class="line">            n = <span class="number">0x9E00</span>+<span class="number">0x400</span><span class="number">-0x9F23</span></span><br><span class="line">            data = data + <span class="string">b'\x00'</span> * n</span><br><span class="line">            f2.write(data)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">'[+] Done'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>Sau khi ch·∫°y code tr√™n, ta c√≥ file <code>fix.exe</code> v√† c√≥ th·ªÉ ƒë∆∞·ª£c unpack b·ªüi <code>UPX</code></p>
<p><img src="images/7_1.png"></p>
<p>Ta m·ªü file m·ªõi l√™n trong IDA v√† b·∫•m F5</p>
<figure class="highlight c++"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-"+" TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  v12 = <span class="number">741548835</span>;</span><br><span class="line">  v13 = <span class="number">1231306510</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;v10, <span class="string">"nPTnaGLkIqdcQwvieFQKGcTGOTbfMjDNmvibfBDdFBhoPaBbtfQuuGWYomtqTFqvBSKdUMmciqKSGZaosWCSoZlcIlyQpOwkcAgw "</span>);</span><br><span class="line">  v14 = <span class="number">67771914</span>;</span><br><span class="line">  v15 = <span class="number">436344355</span>;</span><br><span class="line">  v16 = <span class="number">604530244</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;v11, <span class="string">"KglPFOsQDxBPXmclOpmsdLDEPMRWbMDzwhDGOyqAkVMRvnBeIkpZIhFznwVylfjrkqprBPAdPuaiVoVugQAlyOQQtxBNsTdPZgDH "</span>);</span><br><span class="line">  v17 = <span class="number">745804082</span>;</span><br><span class="line">  v18 = <span class="number">255995178</span>;</span><br><span class="line">    <span class="comment">// truncated ...</span></span><br><span class="line">  sub_401000(&amp;v28, <span class="number">20</span>, &amp;v11, <span class="number">0</span>);</span><br><span class="line">  v3 = MEMORY[<span class="number">0x12418</span>](v9, <span class="number">0x40000000</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">128</span>, <span class="number">0</span>);</span><br><span class="line">  sub_401045(&amp;v9);</span><br><span class="line">  <span class="keyword">if</span> ( v3 != <span class="number">-1</span> )</span><br><span class="line">  {</span><br><span class="line">    v8 = <span class="number">0</span>;</span><br><span class="line">    sub_401000(&amp;v12, <span class="number">61</span>, &amp;v10, v4);</span><br><span class="line">    MEMORY[<span class="number">0x123F8</span>](v3, v9, <span class="number">61</span>, &amp;v8, <span class="number">0</span>);</span><br><span class="line">    sub_401045(&amp;v9);</span><br><span class="line">    MEMORY[<span class="number">0x12426</span>](v3);</span><br><span class="line">    sub_401000(&amp;v28, <span class="number">20</span>, &amp;v11, v5);</span><br><span class="line">    MEMORY[<span class="number">0x12442</span>](<span class="number">0</span>, <span class="number">0</span>, v9, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    sub_401045(&amp;v9);</span><br><span class="line">  }</span><br><span class="line">  v6 = MEMORY[<span class="number">0x123E4</span>](<span class="number">-1</span>);</span><br><span class="line">  MEMORY[<span class="number">0x12404</span>](v6);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>Ta th·∫•y c√≥ m·ªôt s·ªë ch·ªó <code>MEMORY[0x?????]</code>, ƒë√≥ l√† v√¨ khi pack file b·∫±ng <code>UPX</code>, ph·∫ßn <code>Import data</code> n·∫±m ·ªü ƒë√≥ (v√† b·ªã ph√° hu·ª∑), n√™n khi ta th√™m null byte v√†o, n√≥ s·∫Ω kh√¥ng ch√≠nh x√°c, tuy nhi√™n ƒëi·ªÅu n√†y c≈©ng kh√¥ng qu√° quan tr·ªçng.</p>
<p>Hai h√†m <code>sub_401000</code> v√† <code>sub_401045</code> l·∫ßn l∆∞·ª£t l√† hai h√†m set key v√† decrypt data b·∫±ng ph√©p <code>xor</code> c∆° b·∫£n, ta d√πng script sau ƒë·ªÉ solve.</p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">p32</span>(<span class="params">n: <span class="built_in">int</span></span>) -&gt; bytes:</span></span><br><span class="line">    <span class="keyword">return</span> pack(<span class="string">'&lt;I'</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span>(<span class="params">data: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>) -&gt; bytes:</span></span><br><span class="line">    key_len = <span class="built_in">len</span>(key)</span><br><span class="line">    r = <span class="string">b''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        r = r + (data[i] ^ key[i % key_len]).to_bytes(<span class="number">1</span>, <span class="string">'little'</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    d1, d2 = [], []</span><br><span class="line"></span><br><span class="line">    d1.append(<span class="number">741548835</span>)</span><br><span class="line">    d1.append(<span class="number">0x49643F0E</span>)</span><br><span class="line">    d1.append(<span class="number">67771914</span>)</span><br><span class="line">    d1.append(<span class="number">436344355</span>)</span><br><span class="line">    d1.append(<span class="number">604530244</span>)</span><br><span class="line">    d1.append(<span class="number">745804082</span>)</span><br><span class="line">    d1.append(<span class="number">255995178</span>)</span><br><span class="line">    d1.append(<span class="number">224677950</span>)</span><br><span class="line">    d1.append(<span class="number">387646557</span>)</span><br><span class="line">    d1.append(<span class="number">84096534</span>)</span><br><span class="line">    d1.append(<span class="number">134815796</span>)</span><br><span class="line">    d1.append(<span class="number">237248867</span>)</span><br><span class="line">    d1.append(<span class="number">1479808021</span>)</span><br><span class="line">    d1.append(<span class="number">981018906</span>)</span><br><span class="line">    d1.append(<span class="number">1482031104</span>)</span><br><span class="line">    d1.append(<span class="number">84</span>)</span><br><span class="line"></span><br><span class="line">    d2.append(<span class="number">989990456</span>)</span><br><span class="line">    d2.append(<span class="number">874199833</span>)</span><br><span class="line">    d2.append(<span class="number">1042484251</span>)</span><br><span class="line">    d2.append(<span class="number">1108412467</span>)</span><br><span class="line">    d2.append(<span class="number">1931350585</span>)</span><br><span class="line"></span><br><span class="line">    d1 = <span class="string">b''</span>.join([p32(i) <span class="keyword">for</span> i <span class="keyword">in</span> d1])</span><br><span class="line">    d2 = <span class="string">b''</span>.join([p32(i) <span class="keyword">for</span> i <span class="keyword">in</span> d2])</span><br><span class="line"></span><br><span class="line">    k1 = <span class="string">b'nPTnaGLkIqdcQwvieFQKGcTGOTbfMjDNmvibfBDdFBhoPaBbtfQuuGWYomtqTFqvBSKdUMmciqKSGZaosWCSoZlcIlyQpOwkcAgw '</span></span><br><span class="line">    k2 = <span class="string">b'KglPFOsQDxBPXmclOpmsdLDEPMRWbMDzwhDGOyqAkVMRvnBeIkpZIhFznwVylfjrkqprBPAdPuaiVoVugQAlyOQQtxBNsTdPZgDH '</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> (dec(d1,k1))</span><br><span class="line">    <span class="built_in">print</span> (dec(d2,k2))</span><br></pre></td></tr></tbody></table></figure>

<p>Run:</p>
<figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b'MsgBox("Congrats! Your key is: C0rruptGarbag3@flare-on.com")\x00Fqv'</span><br><span class="line">b'sink_the_tanker.vbs\x00'</span><br></pre></td></tr></tbody></table></figure>


<h1 id="3-Wednesday"><a href="#3-Wednesday" class="headerlink" title="3 - Wednesday">3 - Wednesday</a></h1><figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Be the wednesday. Unlike challenge 1, you probably won't be able to beat this game the old fashioned way. Read the README.txt file, it is very important.</span><br></pre></td></tr></tbody></table></figure>

<p>ƒê·ªÅ b√†i cho 1 game 2D, ta m·ªü l√™n ch·∫°y th·ª≠</p>
<p><img src="images/1_2.png"></p>
<p>Game ch·ªâ ƒë∆°n gi·∫£n l√† v∆∞·ª£t qua c√°c ch∆∞·ªõng ng·∫°i v·∫≠t (ng·ªìi xu·ªëng ho·∫∑c nh·∫£y ƒë·ªÉ n√© v·∫≠t th·ªÉ).</p>
<p>Tuy nhi√™n, c√≥ nh·ªØng ch·ªó nh∆∞ h√¨nh tr√™n, nh√¨n b·∫±ng m·∫Øt th√¨ ph·∫£i ng·ªìi xu·ªëng ƒë·ªÉ v∆∞·ª£t qua, nh∆∞ng khi ng·ªìi xu·ªëng th√¨ character c·ªßa ch√∫ng ta die ngay l·∫≠p t·ª©c, ho·∫∑c c√≥ ch·ªó nh√¨n th√¨ ƒë√°ng ra ph·∫£i nh·∫£y l√™n, nh∆∞ng th·∫≠t ra ph·∫£i ng·ªìi xu·ªëng m·ªõi qua ƒë∆∞·ª£c.</p>
<p>Sau 1 th·ªùi gian ng·ªìi ch∆°i game, m√¨nh ph√°t hi·ªán ra r·∫±ng:</p>
<ul>
<li>Game kh√¥ng thay ƒë·ªïi v·ªã tr√≠ c√°c v·∫≠t th·ªÉ sau c√°c l·∫ßn ch·∫øt, ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c 8 ƒëi·ªÉm ƒë·∫ßu ti√™n th√¨ tr·∫°ng th√°i l·∫ßn l∆∞·ª£t l√†: ng·ªìi, ng·ªìi, nh·∫£y, nh·∫£y, ng·ªìi, ng·ªìi, ng·ªìi, nh·∫£y.</li>
<li>Ch·ªâ c√≥ th·ªÉ nh·∫£y ho·∫∑c ng·ªìi m·ªõi v∆∞·ª£t qua ƒë∆∞·ª£c v·∫≠t th·ªÉ, ƒë·ª©ng y√™n l√† die.</li>
</ul>
<p>V·∫≠y ch·ªâ c√≥ 2 tr·∫°ng th√°i l√† c√≥ th·ªÉ gi√∫p ta v∆∞·ª£t qua v·∫≠t th·ªÉ, ƒë·∫øn ƒë√¢y m√¨nh nghƒ© ngay t·ªõi s·ªë nh·ªã ph√¢n, v√¨ s·ªë nh·ªã ph√¢n c≈©ng ch·ªâ c√≥ 2 ch·ªØ s·ªë l√† 0 v√† 1. V·ªõi lo·∫°t tr·∫°ng th√°i nh∆∞ ·ªü tr√™n th√¨ s·ªë nh·ªã ph√¢n c√≥ th·ªÉ l√†: 00110001 ho·∫∑c 11001110.</p>
<p>T√¨m th·ª≠ d√£y binary 00110001 trong memory ta ƒë∆∞·ª£c:</p>
<p><img src="images/2_1.png"></p>
<p>·ªû tr√™n h√¨nh, m√¨nh ƒë√£ select 296 byte, gi√° tr·ªã c·ªßa c√°c byte n√†y ch·ªâ l√† ‚Äú00‚Äù ho·∫∑c ‚Äú01‚Äù. Ta c√≥ th·ªÉ nghƒ© ngay t·ªõi s·ªë nh·ªã ph√¢n v√¨ s·ªë nh·ªã ph√¢n c≈©ng ƒë∆∞·ª£c bi·ªÉu di·ªÖn t·ª´ c√°c con s·ªë 0 v√† 1. V√¨ v·∫≠y ƒëo·∫°n code d∆∞·ªõi ƒë√¢y m√¨nh ƒë√£ gh√©p 8 byte l·∫°i v·ªõi nhau, r·ªìi in ra m√†n h√¨nh. L√Ω do m√¨nh gh√©p 8 m√† ko ph·∫£i l√† 7 hay 9 l√† v√¨ m·ªói byte ƒë∆∞·ª£c t·∫°o n√™n t·ª´ s·ªë nh·ªã ph√¢n c√≥ 8 ch·ªØ s·ªë.</p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    d = [<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(d) % <span class="number">8</span> == <span class="number">0</span></span><br><span class="line">    s = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(d) // <span class="number">8</span>):</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            tmp = tmp | (d[<span class="number">8</span>*i+j] &lt;&lt; (<span class="number">7</span> - j))</span><br><span class="line">        s = s + <span class="built_in">chr</span>(tmp)</span><br><span class="line">    <span class="built_in">print</span> (s)</span><br></pre></td></tr></tbody></table></figure>

<p>Run:</p>
<figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1t_i5_wEdn3sd4y_mY_Dud3s@flare-on.com</span><br></pre></td></tr></tbody></table></figure>

<p>‚Äì</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post" style="display: none;">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">home</a></li>
         
          <li><a href="/about/">about</a></li>
         
          <li><a href="/archives/">articles</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://cyberjutsu.io/publications/">publications</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mo-dau"><span class="toc-number">1.</span> <span class="toc-text">M·ªü ƒë·∫ßu</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Flare-on-CTF"><span class="toc-number">1.1.</span> <span class="toc-text">Flare-on CTF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vi-sao-nen-choi-Flare-on"><span class="toc-number">1.2.</span> <span class="toc-text">V√¨ sao n√™n ch∆°i Flare-on</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Phan-1"><span class="toc-number">1.3.</span> <span class="toc-text">Ph·∫ßn 1</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Fidler"><span class="toc-number">2.</span> <span class="toc-text">1 - Fidler</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-garbage"><span class="toc-number">3.</span> <span class="toc-text">2 - garbage</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-Wednesday"><span class="toc-number">4.</span> <span class="toc-text">3 - Wednesday</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;text=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;is_video=false&amp;description=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=FLAREON 2020 - WRITEUP PH·∫¶N 1&amp;body=Check out this article: https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;name=FLAREON 2020 - WRITEUP PH·∫¶N 1&amp;description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;t=FLAREON 2020 - WRITEUP PH·∫¶N 1"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright ¬©
    
    
    2020-2021 - 
    CyberJutsu Team
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">home</a></li>
         
          <li><a href="/about/">about</a></li>
         
          <li><a href="/archives/">articles</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://cyberjutsu.io/publications/">publications</a></li>
        
      </ul>
    </nav>
  </div>
</footer>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script type="text/javascript" async src="js/analytics.js"></script><script async src="js_1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-180673323-1');
</script>
    </div>
    <!-- styles -->

<link rel="stylesheet" href="css/all.min.css">


<link rel="stylesheet" href="css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="js/jquery.min.js"></script>


<script src="js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="js/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->




</body></html>