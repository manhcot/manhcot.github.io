<!DOCTYPE html><html lang="en"><head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="Mở đầuFlare-on CTFFlare-on là sân chơi CTF hàng năm của những người chơi hệ nhị phân 👨‍💻, reverse engineer, các nhà nghiên cứu về mã độc và bảo mật. Một kỳ Flare-on">
<meta property="og:type" content="article">
<meta property="og:title" content="FLAREON 2020 - WRITEUP PHẦN 1">
<meta property="og:url" content="https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/index.html">
<meta property="og:site_name" content="/ home / cyberjutsu / blog /">
<meta property="og:description" content="Mở đầuFlare-on CTFFlare-on là sân chơi CTF hàng năm của những người chơi hệ nhị phân 👨‍💻, reverse engineer, các nhà nghiên cứu về mã độc và bảo mật. Một kỳ Flare-on">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-12-02T17:00:01.000Z">
<meta property="article:modified_time" content="2020-12-31T03:35:13.713Z">
<meta property="article:author" content="CyberJutsu Team">
<meta property="article:tag" content="flareon">
<meta property="article:tag" content="reverse engineering">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.cyberjutsu.io/images/flareon/1/1.png">
<meta property="og:image" content="images/1_3.png">
    
    
      
        
          <link rel="shortcut icon" href="favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>FLAREON 2020 - WRITEUP PHẦN 1</title>
    <!-- styles -->
    
<link rel="stylesheet" href="css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 5.2.0"></head>

<body class="max-width mx-auto px5 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" style="display: none;"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav" style="display: none;">
      <ul>
         
          <li><a href="/">home</a></li>
         
          <li><a href="/about/">about</a></li>
         
          <li><a href="/archives/">articles</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://cyberjutsu.io/publications/">publications</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/12/24/flareon-phan-2/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;text=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;is_video=false&amp;description=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=FLAREON 2020 - WRITEUP PHẦN 1&amp;body=Check out this article: https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;name=FLAREON 2020 - WRITEUP PHẦN 1&amp;description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;t=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mo-dau"><span class="toc-number">1.</span> <span class="toc-text">Mở đầu</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Flare-on-CTF"><span class="toc-number">1.1.</span> <span class="toc-text">Flare-on CTF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vi-sao-nen-choi-Flare-on"><span class="toc-number">1.2.</span> <span class="toc-text">Vì sao nên chơi Flare-on</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Phan-1"><span class="toc-number">1.3.</span> <span class="toc-text">Phần 1</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Fidler"><span class="toc-number">2.</span> <span class="toc-text">1 - Fidler</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-garbage"><span class="toc-number">3.</span> <span class="toc-text">2 - garbage</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-Wednesday"><span class="toc-number">4.</span> <span class="toc-text">3 - Wednesday</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        FLAREON 2020 - WRITEUP PHẦN 1
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">manhcot</span>
      </span>&gt;&gt;
      
    <div class="postdate">
      
        <time datetime="2020-12-02T17:00:01.000Z" itemprop="datePublished">2020-12-03</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/flareon/" rel="tag">flareon</a>, <a class="tag-link-link" href="/tags/reverse-engineering/" rel="tag">reverse engineering</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <main style="height: 400px">
  <div class="c-glitch" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);">
    <div class="c-glitch__img" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);"></div>
    <div class="c-glitch__img" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);"></div>
    <div class="c-glitch__img" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);"></div>
    <div class="c-glitch__img" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);"></div>
    <div class="c-glitch__img" style="background-image: url(&#x27;images/FlareOn%402x.jpg&#x27;);"></div>
  </div>
</main>

<h1 id="Mo-dau"><a href="#Mo-dau" class="headerlink" title="Mở đầu">Mở đầu</a></h1><h2 id="Flare-on-CTF"><a href="#Flare-on-CTF" class="headerlink" title="Flare-on CTF">Flare-on CTF</a></h2><p>Flare-on là sân chơi CTF hàng năm của những người chơi hệ nhị phân 👨‍💻, reverse engineer, các nhà nghiên cứu về mã độc và bảo mật. Một kỳ Flare-on CTF diễn ra trong vòng 6 tuần, thông thường gồm 11 challenge tương ứng với 11 level đầy đủ các thể loại và platform (Windows, Linux, Python, VBA, .NET, …)</p>
<h2 id="Vi-sao-nen-choi-Flare-on"><a href="#Vi-sao-nen-choi-Flare-on" class="headerlink" title="Vì sao nên chơi Flare-on">Vì sao nên chơi Flare-on</a></h2><ul>
<li>Các challenge này được <code>Fireeye</code> mô tả là “một trong những vấn đề mà team <code>Fireeye</code> phải đối mặt hằng ngày”, tức là những challenge này đều lấy ý tưởng từ những vấn đề có thật (có bài dùng cả malware thật), nên đề bài sẽ có cảm giác “real-world” hơn so với các bài <code>RE</code> trong các đề thi <code>CTF</code> khác.</li>
<li>Nếu bạn là 1 người chơi <code>RE</code> thì không nên bỏ qua Flare-on, nhất là với các bạn mới chơi <code>RE</code>. Bởi vì, đề Flare-on tuy khó, các bạn có thể không giải hết các challenge, nhưng trong vòng 6 tuần đó bạn sẽ học được nhiều thứ mới (như tính kiên trì chẳng hạn 😄 !!)</li>
<li>Sau khi kì thi kết thúc, <code>Fireeye</code> sẽ đưa ra lời giải chi tiết cho các challenge, bạn có thể tham khảo cách họ làm. Ngoài ra trên mạng cũng có rất nhiều write-up cho các bạn tham khảo, từ đó bạn có thể học hỏi cách họ làm, học cách tiếp cận bài toán, dùng tool để giải bài, …</li>
</ul>
<p>Mình bắt đầu chơi Flare-on  từ năm ngoái, và cũng không giải được hết các challenge,  tuy nhiên ít nhất mình đã không bỏ cuộc cho tới phút cuối cùng. Năm nay mình tiếp tục tham gia Flare-on và đã giải được đủ 11 bài, và đây là write-up cho 11 bài đó !</p>
<h2 id="Phan-1"><a href="#Phan-1" class="headerlink" title="Phần 1">Phần 1</a></h2><p>Mình sẽ chia 11 bài writeup ra thành nhiều phần khác nhau 😄, ở phần 1 này chúng ta cùng khởi động với 3 bài đầu tiên đó chính là: <code>Fidler</code> (<a href="/static/flareon2020/solution1.zip">solution</a>), <code>garbage</code> (<a href="/static/flareon2020/solution2.zip">solution</a>) và <code>Wednesday</code> (<a href="/static/flareon2020/solution3.zip">solution</a>)</p>
<h1 id="1-Fidler"><a href="#1-Fidler" class="headerlink" title="1 - Fidler">1 - Fidler</a></h1><figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the Seventh Flare-On Challenge!</span><br><span class="line"></span><br><span class="line">This is a simple game. Win it by any means necessary and the victory screen will reveal the flag. Enter the flag here on this site to score and move on to the next level.</span><br><span class="line"></span><br><span class="line">This challenge is written in Python and is distributed as a runnable EXE and matching source code for your convenience. You can run the source code directly on any Python platform with PyGame if you would prefer.</span><br></pre></td></tr></tbody></table></figure>

<p>Như tiêu đề, bài này bao gồm file <code>.exe</code> và file source code <code>.py</code>.</p>
<p><img src="images/1_1.png"></p>
<p>Chạy file exe:</p>
<p><img src="images/2.png"></p>
<p>Chương trình yêu cầu nhập password, ta mở source code ra:</p>
<p><img src="images/3.png"></p>
<p>Ta dễ dàng lấy được password là <code>ghost</code>, nhập vào, ta sẽ chuyển sang màn hình tiếp theo:</p>
<p><img src="images/4.png"></p>
<p>Ta phải click vào con mèo 100 tỷ lần để lấy được flag, hoặc ta có thể xem chương trình tạo flag như nào để có thể lấy được nó.</p>
<p>Ta có thể mở source code của game này ra để đọc, đó chính là file <code>fidler.py</code>, lướt qua nhìn tên các hàm thì có một hàm liên quan tới “flag”, đó là hàm <code>decode_flag</code>:</p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_flag</span>(<span class="params">frob</span>):</span></span><br><span class="line">    last_value = frob</span><br><span class="line">    encoded_flag = [<span class="number">1135</span>, <span class="number">1038</span>, <span class="number">1126</span>, <span class="number">1028</span>, <span class="number">1117</span>, <span class="number">1071</span>, <span class="number">1094</span>, <span class="number">1077</span>, <span class="number">1121</span>, <span class="number">1087</span>, <span class="number">1110</span>, <span class="number">1092</span>, <span class="number">1072</span>, <span class="number">1095</span>, <span class="number">1090</span>, <span class="number">1027</span>,</span><br><span class="line">                    <span class="number">1127</span>, <span class="number">1040</span>, <span class="number">1137</span>, <span class="number">1030</span>, <span class="number">1127</span>, <span class="number">1099</span>, <span class="number">1062</span>, <span class="number">1101</span>, <span class="number">1123</span>, <span class="number">1027</span>, <span class="number">1136</span>, <span class="number">1054</span>]</span><br><span class="line">    decoded_flag = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encoded_flag)):</span><br><span class="line">        c = encoded_flag[i]</span><br><span class="line">        val = (c - ((i%<span class="number">2</span>)*<span class="number">1</span> + (i%<span class="number">3</span>)*<span class="number">2</span>)) ^ last_value</span><br><span class="line">        decoded_flag.append(val)</span><br><span class="line">        last_value = c</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> decoded_flag])</span><br></pre></td></tr></tbody></table></figure>

<p>Sau đó select chữ <code>"decode_flag"</code> trong <code>notepad++</code>, thì nó sẽ tự select tất cả các chỗ khác có chứa <code>"decode_flag"</code></p>
<p><img src="images/7.png"></p>
<p>Ta có thể thấy 1 reference khác của <code>"decode_flag"</code> ở hàm <code>victory_screen</code>, ta lại tiếp tục select chữ <code>"victory_screen"</code> để tìm reference:</p>
<p><img src="images/8_1.png"></p>
<p>Ta lại tiếp tục làm như trên với hàm <code>game_screen</code>:</p>
<p><img src="images/9.png"></p>
<p>Vậy là ta đã biết hàm <code>game_screen</code> được gọi như nào, tuy nhiên điều đó cũng không quá quan trọng vì ta sẽ chỉ quan tâm tới hàm <code>decode_flag</code>.</p>
<p>Chỉ có duy nhất 1 chỗ gọi hàm <code>decode_flag</code>, đó là chỗ này:</p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ... truncated </span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> done:</span><br><span class="line">    target_amount = (<span class="number">2</span>**<span class="number">36</span>) + (<span class="number">2</span>**<span class="number">35</span>)</span><br><span class="line">    <span class="keyword">if</span> current_coins &gt; (target_amount - <span class="number">2</span>**<span class="number">20</span>):</span><br><span class="line">        <span class="keyword">while</span> current_coins &gt;= (target_amount + <span class="number">2</span>**<span class="number">20</span>):</span><br><span class="line">            current_coins -= <span class="number">2</span>**<span class="number">20</span></span><br><span class="line">        victory_screen(<span class="built_in">int</span>(current_coins / <span class="number">10</span>**<span class="number">8</span>))</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"><span class="comment"># truncated ...</span></span><br></pre></td></tr></tbody></table></figure>

<p>Dễ thấy <code>current_coin</code> phải lớn hơn hoặc bằng <code>2**36+2**35</code> và bé hơn <code>2**36+2**35+2**20</code> thì dòng <code>victory_screen(int(current_coins / 10**8))</code> mới được gọi.</p>
<p>Khi đó ta viết lại đoạn code ở trên với <code>frob=int((2**36+2**35)/10**8)</code></p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> (decode_flag(<span class="built_in">int</span>((<span class="number">2</span>**<span class="number">36</span>+<span class="number">2</span>**<span class="number">35</span>)/<span class="number">10</span>**<span class="number">8</span>)))</span><br></pre></td></tr></tbody></table></figure>

<p>Run:</p>
<figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">idle_with_kitty@flare-on.com</span><br></pre></td></tr></tbody></table></figure>


<h1 id="2-garbage"><a href="#2-garbage" class="headerlink" title="2 - garbage">2 - garbage</a></h1><figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">One of our team members developed a Flare-On challenge but accidentally deleted it. We recovered it using extreme digital forensic techniques but it seems to be corrupted. We would fix it but we are too busy solving today's most important information security threats affecting our global economy. You should be able to get it working again, reverse engineer it, and acquire the flag.</span><br></pre></td></tr></tbody></table></figure>

<p><img src="images/1.png"></p>
<p>Ta giải nén và chạy thử file exe:</p>
<p><img src="images/2_2.png"></p>
<p>File đã bị corrupt đúng như đề bài nói. Tiếp theo ta dùng <code>Detect it easy</code> để lấy thêm thông tin về file.</p>
<p><img src="images/3_1.png"></p>
<blockquote>
<p><code>Detect it easy</code> là một tool dùng để xác định xem 1 file <code>PE</code> được biên dịch bằng compiler nào, được pack bằng packer nào, từ đó ta có thể có sử dụng các tool thích hợp để phân tích file đó.</p>
</blockquote>
<p>File được nén bằng <code>UPX</code>, ta sẽ dùng đúng tool <code>UPX</code> để unpack file này.</p>
<p><img src="images/4_1.png"></p>
<blockquote>
<p><code>UPX</code> là một tool dùng để nén file executable, open source, bạn đọc có thể xem ở <a target="_blank" rel="noopener" href="https://upx.github.io/">đây</a>.</p>
</blockquote>
<p><code>UPX</code> không thể unpack file này, có thể là vì nó đã bị lỗi. Giờ ta mở file lên bằng <code>PE-bear</code> để xem phần nào trong file này bị lỗi.</p>
<p><img src="images/5.png"></p>
<p><img src="images/6.png"></p>
<blockquote>
<p><code>PE-bear</code> là một tool dùng để xem PE header của 1 file PE, bạn đọc có thể tải ở <a target="_blank" rel="noopener" href="https://hshrzd.wordpress.com/pe-bear/">đây</a>.</p>
</blockquote>
<p>Ta thấy ngay phần section <code>.rsrc</code> bị lỗi (màu đỏ).</p>
<p>Ta phân tích tiếp: mục <code>.rsrc</code> có <code>Raw size</code> là <code>0x124</code>, tức là khi map file lên bộ nhớ tại <code>Virtual address 0x19000</code>, phần data thật sự sẽ kết thúc ở <code>0x19123</code>, trong khi ở hình trên thì phần <code>Import Directory</code> bắt đầu ở <code>Virtual address 0x191DC</code>, tức là nằm ngoài vùng data thật sự (3 vùng màu đỏ ở hình trên đều nằm ngoài vùng data).</p>
<p>Như vậy ta chỉ cần pad thêm vào file các byte null để nó có thể bao hết các <code>Virtual address</code> trên. Ta cần thêm vào <code>0x1929C+0x10-(0x19000+0x124) = 0x188</code> byte.</p>
<p>Nhưng chưa đủ, nếu ta thêm chỉ chừng đó byte thì chưa chắc file đã “hoạt động” được, vì dung lượng của file phải chia hết cho <code>File alignment</code> (tham khảo về PE struct tại <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/debug/pe-format">đây</a>).</p>
<p><img src="images/8.png"></p>
<p>Như hình trên, <code>File alignment</code> là <code>0x200</code>. Vậy là sau khi thêm, ta phải đảm bảo là size của file này chia cho <code>0x200</code> dư 0, đoạn code dưới đây mình đã pad thêm cho tới bội của <code>0x200</code> là <code>0x400</code>.</p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'garbage.exe'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'fix.exe'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f2:</span><br><span class="line">            data = f.read()</span><br><span class="line">            n = <span class="number">0x9E00</span>+<span class="number">0x400</span><span class="number">-0x9F23</span></span><br><span class="line">            data = data + <span class="string">b'\x00'</span> * n</span><br><span class="line">            f2.write(data)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">'[+] Done'</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>Sau khi chạy code trên, ta có file <code>fix.exe</code> và có thể được unpack bởi <code>UPX</code></p>
<p><img src="images/7_1.png"></p>
<p>Ta mở file mới lên trong IDA và bấm F5</p>
<figure class="highlight c++"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="comment">// [COLLAPSED LOCAL DECLARATIONS. PRESS KEYPAD CTRL-"+" TO EXPAND]</span></span><br><span class="line"></span><br><span class="line">  v12 = <span class="number">741548835</span>;</span><br><span class="line">  v13 = <span class="number">1231306510</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;v10, <span class="string">"nPTnaGLkIqdcQwvieFQKGcTGOTbfMjDNmvibfBDdFBhoPaBbtfQuuGWYomtqTFqvBSKdUMmciqKSGZaosWCSoZlcIlyQpOwkcAgw "</span>);</span><br><span class="line">  v14 = <span class="number">67771914</span>;</span><br><span class="line">  v15 = <span class="number">436344355</span>;</span><br><span class="line">  v16 = <span class="number">604530244</span>;</span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;v11, <span class="string">"KglPFOsQDxBPXmclOpmsdLDEPMRWbMDzwhDGOyqAkVMRvnBeIkpZIhFznwVylfjrkqprBPAdPuaiVoVugQAlyOQQtxBNsTdPZgDH "</span>);</span><br><span class="line">  v17 = <span class="number">745804082</span>;</span><br><span class="line">  v18 = <span class="number">255995178</span>;</span><br><span class="line">    <span class="comment">// truncated ...</span></span><br><span class="line">  sub_401000(&amp;v28, <span class="number">20</span>, &amp;v11, <span class="number">0</span>);</span><br><span class="line">  v3 = MEMORY[<span class="number">0x12418</span>](v9, <span class="number">0x40000000</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">128</span>, <span class="number">0</span>);</span><br><span class="line">  sub_401045(&amp;v9);</span><br><span class="line">  <span class="keyword">if</span> ( v3 != <span class="number">-1</span> )</span><br><span class="line">  {</span><br><span class="line">    v8 = <span class="number">0</span>;</span><br><span class="line">    sub_401000(&amp;v12, <span class="number">61</span>, &amp;v10, v4);</span><br><span class="line">    MEMORY[<span class="number">0x123F8</span>](v3, v9, <span class="number">61</span>, &amp;v8, <span class="number">0</span>);</span><br><span class="line">    sub_401045(&amp;v9);</span><br><span class="line">    MEMORY[<span class="number">0x12426</span>](v3);</span><br><span class="line">    sub_401000(&amp;v28, <span class="number">20</span>, &amp;v11, v5);</span><br><span class="line">    MEMORY[<span class="number">0x12442</span>](<span class="number">0</span>, <span class="number">0</span>, v9, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    sub_401045(&amp;v9);</span><br><span class="line">  }</span><br><span class="line">  v6 = MEMORY[<span class="number">0x123E4</span>](<span class="number">-1</span>);</span><br><span class="line">  MEMORY[<span class="number">0x12404</span>](v6);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>Ta thấy có một số chỗ <code>MEMORY[0x?????]</code>, đó là vì khi pack file bằng <code>UPX</code>, phần <code>Import data</code> nằm ở đó (và bị phá huỷ), nên khi ta thêm null byte vào, nó sẽ không chính xác, tuy nhiên điều này cũng không quá quan trọng.</p>
<p>Hai hàm <code>sub_401000</code> và <code>sub_401045</code> lần lượt là hai hàm set key và decrypt data bằng phép <code>xor</code> cơ bản, ta dùng script sau để solve.</p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">p32</span>(<span class="params">n: <span class="built_in">int</span></span>) -&gt; bytes:</span></span><br><span class="line">    <span class="keyword">return</span> pack(<span class="string">'&lt;I'</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span>(<span class="params">data: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>) -&gt; bytes:</span></span><br><span class="line">    key_len = <span class="built_in">len</span>(key)</span><br><span class="line">    r = <span class="string">b''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">        r = r + (data[i] ^ key[i % key_len]).to_bytes(<span class="number">1</span>, <span class="string">'little'</span>)</span><br><span class="line">    <span class="keyword">return</span> r</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    d1, d2 = [], []</span><br><span class="line"></span><br><span class="line">    d1.append(<span class="number">741548835</span>)</span><br><span class="line">    d1.append(<span class="number">0x49643F0E</span>)</span><br><span class="line">    d1.append(<span class="number">67771914</span>)</span><br><span class="line">    d1.append(<span class="number">436344355</span>)</span><br><span class="line">    d1.append(<span class="number">604530244</span>)</span><br><span class="line">    d1.append(<span class="number">745804082</span>)</span><br><span class="line">    d1.append(<span class="number">255995178</span>)</span><br><span class="line">    d1.append(<span class="number">224677950</span>)</span><br><span class="line">    d1.append(<span class="number">387646557</span>)</span><br><span class="line">    d1.append(<span class="number">84096534</span>)</span><br><span class="line">    d1.append(<span class="number">134815796</span>)</span><br><span class="line">    d1.append(<span class="number">237248867</span>)</span><br><span class="line">    d1.append(<span class="number">1479808021</span>)</span><br><span class="line">    d1.append(<span class="number">981018906</span>)</span><br><span class="line">    d1.append(<span class="number">1482031104</span>)</span><br><span class="line">    d1.append(<span class="number">84</span>)</span><br><span class="line"></span><br><span class="line">    d2.append(<span class="number">989990456</span>)</span><br><span class="line">    d2.append(<span class="number">874199833</span>)</span><br><span class="line">    d2.append(<span class="number">1042484251</span>)</span><br><span class="line">    d2.append(<span class="number">1108412467</span>)</span><br><span class="line">    d2.append(<span class="number">1931350585</span>)</span><br><span class="line"></span><br><span class="line">    d1 = <span class="string">b''</span>.join([p32(i) <span class="keyword">for</span> i <span class="keyword">in</span> d1])</span><br><span class="line">    d2 = <span class="string">b''</span>.join([p32(i) <span class="keyword">for</span> i <span class="keyword">in</span> d2])</span><br><span class="line"></span><br><span class="line">    k1 = <span class="string">b'nPTnaGLkIqdcQwvieFQKGcTGOTbfMjDNmvibfBDdFBhoPaBbtfQuuGWYomtqTFqvBSKdUMmciqKSGZaosWCSoZlcIlyQpOwkcAgw '</span></span><br><span class="line">    k2 = <span class="string">b'KglPFOsQDxBPXmclOpmsdLDEPMRWbMDzwhDGOyqAkVMRvnBeIkpZIhFznwVylfjrkqprBPAdPuaiVoVugQAlyOQQtxBNsTdPZgDH '</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> (dec(d1,k1))</span><br><span class="line">    <span class="built_in">print</span> (dec(d2,k2))</span><br></pre></td></tr></tbody></table></figure>

<p>Run:</p>
<figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b'MsgBox("Congrats! Your key is: C0rruptGarbag3@flare-on.com")\x00Fqv'</span><br><span class="line">b'sink_the_tanker.vbs\x00'</span><br></pre></td></tr></tbody></table></figure>


<h1 id="3-Wednesday"><a href="#3-Wednesday" class="headerlink" title="3 - Wednesday">3 - Wednesday</a></h1><figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Be the wednesday. Unlike challenge 1, you probably won't be able to beat this game the old fashioned way. Read the README.txt file, it is very important.</span><br></pre></td></tr></tbody></table></figure>

<p>Đề bài cho 1 game 2D, ta mở lên chạy thử</p>
<p><img src="images/1_2.png"></p>
<p>Game chỉ đơn giản là vượt qua các chướng ngại vật (ngồi xuống hoặc nhảy để né vật thể).</p>
<p>Tuy nhiên, có những chỗ như hình trên, nhìn bằng mắt thì phải ngồi xuống để vượt qua, nhưng khi ngồi xuống thì character của chúng ta die ngay lập tức, hoặc có chỗ nhìn thì đáng ra phải nhảy lên, nhưng thật ra phải ngồi xuống mới qua được.</p>
<p>Sau 1 thời gian ngồi chơi game, mình phát hiện ra rằng:</p>
<ul>
<li>Game không thay đổi vị trí các vật thể sau các lần chết, để đạt được 8 điểm đầu tiên thì trạng thái lần lượt là: ngồi, ngồi, nhảy, nhảy, ngồi, ngồi, ngồi, nhảy.</li>
<li>Chỉ có thể nhảy hoặc ngồi mới vượt qua được vật thể, đứng yên là die.</li>
</ul>
<p>Vậy chỉ có 2 trạng thái là có thể giúp ta vượt qua vật thể, đến đây mình nghĩ ngay tới số nhị phân, vì số nhị phân cũng chỉ có 2 chữ số là 0 và 1. Với loạt trạng thái như ở trên thì số nhị phân có thể là: 00110001 hoặc 11001110.</p>
<p>Tìm thử dãy binary 00110001 trong memory ta được:</p>
<p><img src="images/2_1.png"></p>
<p>Ở trên hình, mình đã select 296 byte, giá trị của các byte này chỉ là “00” hoặc “01”. Ta có thể nghĩ ngay tới số nhị phân vì số nhị phân cũng được biểu diễn từ các con số 0 và 1. Vì vậy đoạn code dưới đây mình đã ghép 8 byte lại với nhau, rồi in ra màn hình. Lý do mình ghép 8 mà ko phải là 7 hay 9 là vì mỗi byte được tạo nên từ số nhị phân có 8 chữ số.</p>
<figure class="highlight python"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    d = [<span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>,</span><br><span class="line">         <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x01</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(d) % <span class="number">8</span> == <span class="number">0</span></span><br><span class="line">    s = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(d) // <span class="number">8</span>):</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            tmp = tmp | (d[<span class="number">8</span>*i+j] &lt;&lt; (<span class="number">7</span> - j))</span><br><span class="line">        s = s + <span class="built_in">chr</span>(tmp)</span><br><span class="line">    <span class="built_in">print</span> (s)</span><br></pre></td></tr></tbody></table></figure>

<p>Run:</p>
<figure class="highlight plain"><span class="btn-copy tooltipped tooltipped-sw" aria-label="Copy to clipboard!"><i class="far fa-clone"></i></span><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1t_i5_wEdn3sd4y_mY_Dud3s@flare-on.com</span><br></pre></td></tr></tbody></table></figure>

<p>–</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post" style="display: none;">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">home</a></li>
         
          <li><a href="/about/">about</a></li>
         
          <li><a href="/archives/">articles</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://cyberjutsu.io/publications/">publications</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Mo-dau"><span class="toc-number">1.</span> <span class="toc-text">Mở đầu</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Flare-on-CTF"><span class="toc-number">1.1.</span> <span class="toc-text">Flare-on CTF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vi-sao-nen-choi-Flare-on"><span class="toc-number">1.2.</span> <span class="toc-text">Vì sao nên chơi Flare-on</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Phan-1"><span class="toc-number">1.3.</span> <span class="toc-text">Phần 1</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Fidler"><span class="toc-number">2.</span> <span class="toc-text">1 - Fidler</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-garbage"><span class="toc-number">3.</span> <span class="toc-text">2 - garbage</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-Wednesday"><span class="toc-number">4.</span> <span class="toc-text">3 - Wednesday</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;text=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;is_video=false&amp;description=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=FLAREON 2020 - WRITEUP PHẦN 1&amp;body=Check out this article: https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;title=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;name=FLAREON 2020 - WRITEUP PHẦN 1&amp;description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.cyberjutsu.io/2020/12/03/flareon-phan-1/&amp;t=FLAREON 2020 - WRITEUP PHẦN 1"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright ©
    
    
    2020-2021 - 
    CyberJutsu Team
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">home</a></li>
         
          <li><a href="/about/">about</a></li>
         
          <li><a href="/archives/">articles</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://cyberjutsu.io/publications/">publications</a></li>
        
      </ul>
    </nav>
  </div>
</footer>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script type="text/javascript" async src="js/analytics.js"></script><script async src="js_1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-180673323-1');
</script>
    </div>
    <!-- styles -->

<link rel="stylesheet" href="css/all.min.css">


<link rel="stylesheet" href="css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="js/jquery.min.js"></script>


<script src="js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="js/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->




</body></html>